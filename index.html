<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dr. Six-Seven's Surgery Lab</title>
<style>
  body { font-family: Arial, sans-serif; background: #f0f0f0; text-align: center; }
  #gameArea { margin: 20px auto; width: 600px; height: 500px; background: #fff; border: 2px solid #333; position: relative; overflow: hidden; }
  .tool { width: 80px; height: 50px; margin: 5px; cursor: grab; display: inline-block; line-height: 50px; color: white; font-weight: bold; border-radius: 8px; user-select: none; }
  #toolbox { margin: 10px; }
  #instructions { font-weight: bold; margin: 10px; }
  #patient { width: 200px; height: 200px; background: #ff9999; position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); border-radius: 15px; display: flex; justify-content: center; align-items: center; font-weight: bold; color: #333; }
  .highlight { border: 3px dashed green; }
  #confetti { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; }
</style>
</head>
<body>

<h1>Dr. Six-Seven's Surgery Lab</h1>
<div id="instructions">Welcome! Follow Dr. Six-Seven's instructions.</div>

<div id="gameArea">
  <div id="patient">Patient</div>
  <canvas id="confetti"></canvas>
</div>

<div id="toolbox">
  <div class="tool" id="scalpel" draggable="true" style="background: #444;">Scalpel</div>
  <div class="tool" id="clamp" draggable="true" style="background: #0077cc;">Clamp</div>
  <div class="tool" id="sutures" draggable="true" style="background: #22cc22;">Sutures</div>
  <div class="tool" id="cupcake" draggable="true" style="background: #cc22cc;">Cupcake</div>
</div>

<script>
let currentStep = 0;
const instructions = [
  "Step 1: Wash your hands and get ready. Click the scalpel when ready to start surgery.",
  "Step 2: Grab the correct tools: scalpel, clamp, sutures. Leave the cupcake!",
  "Step 3: Make a careful incision on the patient's abdomen by dropping the scalpel.",
  "Step 4: Locate the aneurysm and place the clamps correctly.",
  "Step 5: Stitch the graft along the dotted line using the sutures.",
  "Step 6: Close the incision carefully and finish surgery!"
];

const gameArea = document.getElementById("gameArea");
const instructionDiv = document.getElementById("instructions");
const scalpel = document.getElementById("scalpel");
const clamp = document.getElementById("clamp");
const sutures = document.getElementById("sutures");
const cupcake = document.getElementById("cupcake");

const tools = { scalpel, clamp, sutures, cupcake };

// Update instructions
function nextStep() {
  currentStep++;
  if(currentStep < instructions.length) {
    instructionDiv.textContent = "Dr. Six-Seven: " + instructions[currentStep];
  } else {
    instructionDiv.textContent = "ðŸŽ‰ Surgery complete! Dr. Six-Seven says: Excellent job!";
    launchConfetti();
  }
}

// Drag and drop
Object.values(tools).forEach(tool => {
  tool.addEventListener('dragstart', e => {
    e.dataTransfer.setData("text", e.target.id);
  });
});

gameArea.addEventListener('dragover', e => e.preventDefault());
gameArea.addEventListener('drop', e => {
  e.preventDefault();
  const id = e.dataTransfer.getData("text");

  if(currentStep === 0 && id === "scalpel") nextStep();
  else if(currentStep === 1 && (id === "scalpel" || id === "clamp" || id === "sutures")) nextStep();
  else if(currentStep === 1 && id === "cupcake") alert("Dr. Six-Seven: Nope! Leave the cupcake!");
  else if(currentStep === 2 && id === "scalpel") nextStep();
  else if(currentStep === 3 && id === "clamp") nextStep();
  else if(currentStep === 4 && id === "sutures") nextStep();
  else if(currentStep === 5) nextStep();
  else alert("Dr. Six-Seven: Thatâ€™s not right, try the correct tool!");
});

// Confetti effect
function launchConfetti() {
  const canvas = document.getElementById('confetti');
  const ctx = canvas.getContext('2d');
  canvas.width = gameArea.clientWidth;
  canvas.height = gameArea.clientHeight;

  let confetti = [];
  for(let i=0;i<100;i++){
    confetti.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*6+2, d: Math.random()*100});
  }

  function draw() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    confetti.forEach(c=>{
      ctx.beginPath();
      ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
      ctx.fillStyle = "hsl(" + Math.random()*360 + ", 100%, 50%)";
      ctx.fill();
      c.y += Math.cos(c.d)+1+ c.r/2;
      c.x += Math.sin(c.d);
      if(c.y>canvas.height) c.y=0;
    });
    requestAnimationFrame(draw);
  }
  draw();
}

// Start
instructionDiv.textContent = "Dr. Six-Seven: " + instructions[currentStep];
</script>

</body>
</html>
